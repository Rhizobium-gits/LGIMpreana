set terminal svg size 1200,600 enhanced font 'Arial,12' background '#FFFFFF'
set output '/tmp/microbiome_results/Figure2_StackedBar.svg'

set title 'Taxonomic Composition' font 'Arial Bold,14'
set style data histograms
set style histogram rowstacked
set style fill solid 0.8 border -1
set boxwidth 0.75
set key outside right top font 'Arial,9'
set ylabel 'Relative Abundance' font 'Arial Bold,11'
set yrange [0:1]
unset xtics
set xlabel 'Samples' font 'Arial Bold,11'

$data << EOD
0 0.4902 0.0000 0.0216 0.0791 0.1033 0.0263 0.0261 0.0074 0.0091 0.0000
1 0.4805 0.0000 0.0333 0.0893 0.0906 0.0209 0.0248 0.0093 0.0130 0.0000
2 0.5072 0.0000 0.0314 0.0531 0.0880 0.0128 0.0413 0.0056 0.0131 0.0000
3 0.4400 0.0000 0.0491 0.0619 0.1343 0.0384 0.0108 0.0183 0.0293 0.0000
4 0.4630 0.0000 0.0536 0.0531 0.1182 0.0262 0.0342 0.0148 0.0405 0.0000
5 0.4871 0.0000 0.0507 0.0748 0.1264 0.0287 0.0144 0.0276 0.0242 0.0000
6 0.3111 0.0000 0.0595 0.0328 0.2648 0.0790 0.0009 0.0252 0.0634 0.0000
7 0.3193 0.0000 0.0726 0.0444 0.2374 0.0624 0.0091 0.0441 0.0497 0.0000
8 0.3591 0.0000 0.1003 0.0306 0.2513 0.0514 0.0062 0.0372 0.0257 0.0000
9 0.5589 0.0000 0.0136 0.0637 0.0542 0.0114 0.0394 0.0101 0.0082 0.0000
10 0.4805 0.0000 0.0316 0.0714 0.0700 0.0099 0.0454 0.0060 0.0222 0.0003
11 0.5135 0.0000 0.0314 0.0551 0.0807 0.0111 0.0398 0.0104 0.0087 0.0000
12 0.5155 0.0000 0.0423 0.0541 0.1600 0.0116 0.0189 0.0213 0.0280 0.0000
13 0.5494 0.0000 0.0402 0.0594 0.0894 0.0322 0.0099 0.0091 0.0185 0.0000
14 0.5157 0.0000 0.0471 0.0299 0.1384 0.0336 0.0181 0.0219 0.0229 0.0000
15 0.4038 0.0000 0.0809 0.0290 0.2065 0.0447 0.0093 0.0223 0.0413 0.0000
16 0.4432 0.0000 0.0718 0.0234 0.2192 0.0270 0.0093 0.0277 0.0269 0.0000
17 0.3635 0.0000 0.0842 0.0333 0.2489 0.0533 0.0060 0.0081 0.0393 0.0000
18 0.4787 0.0000 0.0313 0.0738 0.0495 0.0069 0.0528 0.0206 0.0118 0.0000
19 0.4719 0.0000 0.0161 0.0528 0.0426 0.0236 0.0484 0.0058 0.0180 0.0000
20 0.5143 0.0000 0.0160 0.0669 0.0636 0.0087 0.0481 0.0037 0.0118 0.0000
21 0.4763 0.0000 0.0239 0.0513 0.1295 0.0203 0.0297 0.0168 0.0209 0.0000
22 0.5426 0.0000 0.0313 0.0366 0.0925 0.0254 0.0176 0.0149 0.0222 0.0000
23 0.4940 0.0000 0.0436 0.0572 0.1231 0.0194 0.0160 0.0121 0.0219 0.0000
24 0.3550 0.0000 0.0726 0.0540 0.2335 0.0427 0.0126 0.0153 0.0392 0.0000
25 0.3963 0.0000 0.0934 0.0314 0.1913 0.0389 0.0100 0.0322 0.0376 0.0000
26 0.4201 0.0000 0.0744 0.0417 0.2027 0.0272 0.0039 0.0276 0.0241 0.0000
27 0.3700 0.0000 0.0349 0.0818 0.1322 0.0221 0.0332 0.0204 0.0482 0.0003
28 0.3953 0.0000 0.0321 0.0844 0.0931 0.0313 0.0486 0.0150 0.0412 0.0000
29 0.3199 0.0000 0.0494 0.0931 0.1249 0.0351 0.0262 0.0149 0.0303 0.0000
30 0.4176 0.0000 0.0804 0.0488 0.1665 0.0365 0.0110 0.0288 0.0422 0.0000
31 0.3707 0.0000 0.0676 0.0868 0.1667 0.0521 0.0091 0.0218 0.0450 0.0000
32 0.3319 0.0000 0.0982 0.0526 0.1593 0.0371 0.0099 0.0365 0.0574 0.0000
33 0.2039 0.0000 0.1303 0.0218 0.3231 0.0710 0.0035 0.0312 0.0816 0.0000
34 0.2353 0.0000 0.1197 0.0252 0.2539 0.0607 0.0019 0.0370 0.1007 0.0000
35 0.1804 0.0000 0.0901 0.0327 0.2904 0.0880 0.0003 0.0287 0.1028 0.0000
36 0.5615 0.0000 0.0105 0.0646 0.0396 0.0065 0.0595 0.0044 0.0049 0.0000
37 0.5433 0.0000 0.0094 0.0600 0.0369 0.0099 0.0489 0.0049 0.0075 0.0000
38 0.5489 0.0000 0.0196 0.0849 0.0432 0.0106 0.0396 0.0032 0.0038 0.0000
39 0.5826 0.0000 0.0237 0.0526 0.0594 0.0148 0.0257 0.0212 0.0141 0.0000
40 0.5799 0.0000 0.0250 0.0533 0.0716 0.0151 0.0330 0.0051 0.0135 0.0000
41 0.5531 0.0000 0.0396 0.0539 0.0848 0.0130 0.0095 0.0069 0.0197 0.0000
42 0.4757 0.0000 0.0456 0.0292 0.1864 0.0287 0.0147 0.0268 0.0369 0.0000
43 0.5195 0.0000 0.0628 0.0306 0.1524 0.0129 0.0217 0.0124 0.0294 0.0000
44 0.5312 0.0001 0.0671 0.0432 0.1482 0.0209 0.0025 0.0182 0.0309 0.0000
45 0.1301 0.3492 0.0618 0.0446 0.0030 0.0077 0.0190 0.0345 0.0009 0.0983
46 0.1114 0.4101 0.0577 0.0468 0.0000 0.0074 0.0238 0.0386 0.0054 0.0446
47 0.1050 0.4473 0.0469 0.0686 0.0001 0.0102 0.0179 0.0409 0.0016 0.0416
48 0.1369 0.3244 0.1095 0.0394 0.0000 0.0250 0.0107 0.0653 0.0126 0.0409
49 0.0747 0.3453 0.0978 0.0525 0.0000 0.0235 0.0105 0.0577 0.0177 0.0553
50 0.1146 0.3233 0.1016 0.0424 0.0000 0.0103 0.0110 0.0797 0.0058 0.0589
51 0.0679 0.2404 0.1496 0.0338 0.0000 0.0260 0.0026 0.1125 0.0115 0.0773
52 0.0798 0.2098 0.2182 0.0261 0.0000 0.0212 0.0015 0.0865 0.0153 0.0666
53 0.0853 0.2104 0.2262 0.0257 0.0001 0.0226 0.0048 0.1159 0.0194 0.0623
54 0.1373 0.3300 0.0579 0.0568 0.0000 0.0027 0.0146 0.0418 0.0019 0.0579
55 0.1582 0.3922 0.0563 0.0451 0.0000 0.0091 0.0129 0.0202 0.0012 0.0425
56 0.1434 0.3267 0.0552 0.0449 0.0000 0.0012 0.0432 0.0414 0.0005 0.0272
57 0.1399 0.3646 0.1098 0.0315 0.0000 0.0064 0.0070 0.0394 0.0029 0.0559
58 0.1109 0.3509 0.0763 0.0451 0.0011 0.0100 0.0096 0.0815 0.0045 0.0480
59 0.1071 0.3166 0.0947 0.0564 0.0000 0.0084 0.0089 0.0436 0.0059 0.0545
60 0.0794 0.2880 0.1749 0.0433 0.0001 0.0128 0.0067 0.0790 0.0083 0.0707
61 0.1209 0.2658 0.1254 0.0300 0.0000 0.0160 0.0035 0.0915 0.0160 0.0642
62 0.0666 0.2803 0.1711 0.0385 0.0000 0.0300 0.0069 0.1071 0.0027 0.0503
63 0.1527 0.3403 0.0307 0.0834 0.0000 0.0045 0.0262 0.0235 0.0053 0.0412
64 0.1078 0.3846 0.0460 0.0533 0.0000 0.0049 0.0222 0.0328 0.0019 0.0644
65 0.0917 0.4497 0.0390 0.0448 0.0000 0.0049 0.0227 0.0327 0.0014 0.0621
66 0.1284 0.3446 0.0727 0.0594 0.0000 0.0049 0.0124 0.0505 0.0049 0.0680
67 0.1195 0.3771 0.0632 0.0489 0.0000 0.0130 0.0092 0.0491 0.0057 0.0529
68 0.1584 0.3209 0.0727 0.0487 0.0000 0.0170 0.0170 0.0494 0.0067 0.0482
69 0.0903 0.2804 0.1622 0.0242 0.0000 0.0157 0.0049 0.1123 0.0100 0.0940
70 0.1143 0.2467 0.1695 0.0279 0.0002 0.0130 0.0039 0.1086 0.0086 0.0676
71 0.1046 0.2691 0.1456 0.0551 0.0000 0.0132 0.0080 0.1051 0.0062 0.0671
72 0.0918 0.2687 0.0922 0.0651 0.0000 0.0130 0.0250 0.0699 0.0094 0.0849
73 0.1082 0.3309 0.0611 0.0508 0.0000 0.0259 0.0108 0.0403 0.0104 0.0938
74 0.1020 0.2715 0.0632 0.0777 0.0003 0.0126 0.0109 0.0673 0.0124 0.0573
75 0.0853 0.2509 0.1762 0.0544 0.0000 0.0174 0.0051 0.0582 0.0096 0.0448
76 0.0758 0.2540 0.1617 0.0373 0.0000 0.0162 0.0025 0.0831 0.0130 0.0844
77 0.0770 0.2574 0.1236 0.0477 0.0000 0.0158 0.0029 0.1043 0.0122 0.0767
78 0.0511 0.1324 0.2655 0.0222 0.0001 0.0289 0.0004 0.1495 0.0264 0.0613
79 0.0550 0.1622 0.2118 0.0164 0.0003 0.0436 0.0005 0.1411 0.0244 0.0560
80 0.0444 0.1548 0.2669 0.0331 0.0000 0.0521 0.0000 0.0827 0.0222 0.0704
81 0.1492 0.4058 0.0256 0.0694 0.0000 0.0003 0.0409 0.0196 0.0004 0.0504
82 0.1552 0.4219 0.0215 0.0482 0.0001 0.0003 0.0310 0.0197 0.0000 0.0579
83 0.1443 0.3734 0.0284 0.0522 0.0000 0.0051 0.0219 0.0211 0.0023 0.0521
84 0.1267 0.4475 0.0414 0.0591 0.0000 0.0015 0.0235 0.0313 0.0032 0.0540
85 0.1262 0.4383 0.0859 0.0414 0.0000 0.0053 0.0114 0.0347 0.0023 0.0536
86 0.1317 0.3906 0.0626 0.0515 0.0000 0.0141 0.0300 0.0414 0.0044 0.0435
87 0.0895 0.3495 0.1448 0.0289 0.0000 0.0111 0.0043 0.0785 0.0040 0.0683
88 0.1368 0.2660 0.1591 0.0326 0.0000 0.0216 0.0067 0.0777 0.0030 0.0680
89 0.1241 0.2892 0.1253 0.0574 0.0000 0.0121 0.0125 0.0617 0.0032 0.0733
90 0.1827 0.0063 0.0689 0.0961 0.0127 0.0579 0.0890 0.0000 0.0289 0.0034
91 0.1848 0.0028 0.0934 0.0967 0.0047 0.0469 0.0615 0.0008 0.0280 0.0004
92 0.1510 0.0127 0.0853 0.1035 0.0115 0.0458 0.0665 0.0000 0.0142 0.0002
93 0.1762 0.0006 0.1622 0.1183 0.0115 0.0836 0.0273 0.0000 0.0313 0.0025
94 0.2079 0.0054 0.1517 0.0876 0.0215 0.0730 0.0439 0.0002 0.0340 0.0037
95 0.1603 0.0017 0.1733 0.0824 0.0101 0.0569 0.0495 0.0000 0.0297 0.0065
96 0.1837 0.0011 0.2358 0.0705 0.0205 0.1161 0.0156 0.0000 0.0432 0.0001
97 0.1066 0.0050 0.2595 0.0648 0.0275 0.1496 0.0062 0.0008 0.0474 0.0016
98 0.1694 0.0017 0.1962 0.0529 0.0302 0.1449 0.0133 0.0000 0.0701 0.0000
99 0.2393 0.0017 0.0765 0.0705 0.0020 0.0169 0.1047 0.0000 0.0225 0.0005
100 0.1839 0.0053 0.0530 0.1159 0.0058 0.0296 0.0971 0.0000 0.0098 0.0003
101 0.2041 0.0024 0.0583 0.1106 0.0092 0.0317 0.0914 0.0000 0.0113 0.0016
102 0.1706 0.0058 0.1550 0.1090 0.0077 0.0593 0.0355 0.0001 0.0220 0.0023
103 0.2141 0.0067 0.1447 0.0824 0.0151 0.0541 0.0471 0.0000 0.0270 0.0008
104 0.2285 0.0093 0.1347 0.0986 0.0211 0.0657 0.0462 0.0000 0.0244 0.0021
105 0.1888 0.0002 0.2189 0.0646 0.0157 0.1156 0.0134 0.0000 0.0451 0.0038
106 0.1924 0.0056 0.2480 0.0549 0.0274 0.0851 0.0217 0.0000 0.0314 0.0010
107 0.1884 0.0001 0.2544 0.0684 0.0192 0.0802 0.0179 0.0000 0.0459 0.0022
108 0.1990 0.0021 0.0589 0.1091 0.0120 0.0318 0.1072 0.0000 0.0151 0.0008
109 0.1942 0.0058 0.0557 0.1173 0.0110 0.0269 0.0955 0.0000 0.0090 0.0003
110 0.2190 0.0071 0.0447 0.1040 0.0034 0.0155 0.1207 0.0000 0.0088 0.0042
111 0.2738 0.0048 0.1098 0.0739 0.0221 0.0416 0.0447 0.0000 0.0194 0.0006
112 0.2288 0.0040 0.0770 0.0694 0.0045 0.0488 0.0614 0.0000 0.0193 0.0003
113 0.2214 0.0040 0.1080 0.0879 0.0166 0.0391 0.0785 0.0002 0.0210 0.0010
114 0.1612 0.0045 0.2209 0.0748 0.0181 0.0988 0.0245 0.0000 0.0413 0.0007
115 0.2348 0.0016 0.2083 0.0496 0.0133 0.0823 0.0208 0.0000 0.0385 0.0001
116 0.2260 0.0024 0.1996 0.0651 0.0184 0.0917 0.0191 0.0000 0.0266 0.0001
117 0.1549 0.0032 0.1213 0.1207 0.0102 0.0419 0.0697 0.0000 0.0340 0.0008
118 0.1214 0.0037 0.1172 0.1119 0.0259 0.0541 0.0601 0.0000 0.0417 0.0005
119 0.1533 0.0051 0.1051 0.1221 0.0110 0.0405 0.0551 0.0000 0.0491 0.0021
120 0.1289 0.0066 0.1792 0.0864 0.0192 0.1177 0.0361 0.0000 0.0442 0.0055
121 0.1205 0.0006 0.1855 0.0650 0.0080 0.0946 0.0288 0.0000 0.0651 0.0013
122 0.1457 0.0030 0.1927 0.0726 0.0142 0.0867 0.0331 0.0000 0.0555 0.0006
123 0.0947 0.0002 0.2959 0.0317 0.0265 0.0992 0.0027 0.0003 0.0683 0.0023
124 0.0858 0.0044 0.2503 0.0434 0.0238 0.1130 0.0155 0.0000 0.0754 0.0003
125 0.0866 0.0009 0.2233 0.0357 0.0270 0.1452 0.0054 0.0000 0.1321 0.0002
126 0.1696 0.0097 0.0318 0.0983 0.0029 0.0219 0.1235 0.0000 0.0068 0.0053
127 0.2187 0.0140 0.0393 0.0767 0.0039 0.0201 0.1016 0.0000 0.0068 0.0038
128 0.2347 0.0075 0.0381 0.0870 0.0063 0.0187 0.1220 0.0000 0.0078 0.0030
129 0.2276 0.0042 0.0885 0.0803 0.0052 0.0332 0.0816 0.0000 0.0127 0.0011
130 0.2091 0.0074 0.0780 0.1353 0.0085 0.0364 0.0904 0.0000 0.0164 0.0011
131 0.3056 0.0026 0.0693 0.0867 0.0044 0.0219 0.0701 0.0000 0.0142 0.0025
132 0.1966 0.0031 0.2050 0.0816 0.0147 0.0538 0.0386 0.0039 0.0527 0.0017
133 0.2199 0.0024 0.1729 0.0967 0.0186 0.0833 0.0312 0.0000 0.0361 0.0015
134 0.2382 0.0038 0.1760 0.0700 0.0114 0.0908 0.0317 0.0000 0.0275 0.0006
EOD

plot $data using 2 title 'Bacteroides' lc rgb '#E64B35', \
     $data using 3 title 'Prevotella' lc rgb '#4DBBD5', \
     $data using 4 title 'Staphylococcus' lc rgb '#00A087', \
     $data using 5 title 'Blautia' lc rgb '#3C5488', \
     $data using 6 title 'Pseudomonas' lc rgb '#F39B7F', \
     $data using 7 title 'Escherichia_Shigella' lc rgb '#8491B4', \
     $data using 8 title 'Faecalibacterium' lc rgb '#91D1C2', \
     $data using 9 title 'Acinetobacter' lc rgb '#DC0000', \
     $data using 10 title 'Streptococcus' lc rgb '#7E6148', \
     $data using 11 title 'Veillonella' lc rgb '#B09C85'
